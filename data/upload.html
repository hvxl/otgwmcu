<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>File upload</title>
<link rel="icon" type="image/png" href="favicon.png">
<link rel="stylesheet" type="text/css" href="otgwmcu.css">
<style>
ul {
  margin: 0px;
}
</style>
</head>
<body>
<div id="leftmenu">
<h2>Links</h2>
<a href="index.html">Status summary</a>
<a href="otlog.html">Message log</a>
<a href="firmware.html">Firmware upgrade</a>
<br>
<a href="about.html">About</a>
</div>
</div>
<div>
<h1>Upload a file</h1>
<form method="post" enctype="multipart/form-data">
  <input type="hidden" id="dir" name="directory" value="">
  Source file: <input type="file" id="filename" name="name" required>
  <div id="version" style="display: none;">
  <br>
  Version: <input type="text" name="version" value="1.0" size="5" pattern="(\d+\.)*\d+" required title="Version number: dot-separated positive integers">
  </div>
  <br><br>
  <input class="button" type="submit" value="Upload">
</form>
</div>
<script>
let dir = document.getElementById("dir")
if (dir) {
    let query = new URLSearchParams(window.location.search)
    let value = query.get("pic")
    if (['pic16f88', 'pic16f1847'].includes(value)) {
        dir.value = value
	let w = document.getElementById("filename")
	if (w) w.accept = ".hex"
	w = document.getElementById("version")
	if (w) w.style.display = ""
    }
}
</script>
</body>
</html>
